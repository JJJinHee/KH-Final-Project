<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- 폰트  -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR&display=swap" rel="stylesheet"> 
    <!-- 공통 css -->
    <link type="text/css" rel="stylesheet" href="/css/common.css">
    <!-- 나현 css (메인, 관리자)-->
    <link type="text/css" rel="stylesheet" href="/css/nh.css">
    <!-- 공통 js -->
    <script type="text/javascript" src="/js/common.js"></script>
    
    <!-- css -->
    <link type="text/css" rel="stylesheet" href="/css/member/signUp.css"> 

<meta id="_csrf" name="_csrf" th:content="${_csrf.token}"/>
<meta id="_csrf_header" name="_csrf_header" th:content="${_csrf.headerName}"/>
<title>다나은 동물병원</title>
</head>
    <body>   
    <div th:replace="fragments/header.html"></div>
    
        <div class="photo">
            <img class="logo" src="/images/member/memberService.png">
        </div>
        <div class="wrapper">
            <img src="/images/member/memberInfo.png"> 
            <div class="infoForm item">
                <label class="etc">회원 가입을 위해 모든 항목을 기입해주십시오.</label><br><br>
                 <form id="joinForm" th:action="@{/member/signUp}" method="post" onsubmit="return validate();">
                <label for="userId" class="label">아이디 </label> 
                <input class ="input all" type="text" name="id" id="userId" size="20" minlength="8" maxlength="10" placeholder="아이디를 입력하세요" required>
                <input type="button" class="button1" id="idCheck" value="중복확인">  
                <br>
                <label for="userPwd" class="label">비밀번호 </label> 
                <input class ="input all" type="password" name="pwd" id="userPwd" minlength="8" maxlength="15" placeholder="비밀번호를 입력하세요" required>
                <label id="pwdCheck_div">&nbsp;</label>
                <br>
                <label for="userPwd2" class="label">비밀번호 재확인 </label> 
                <input class ="input all" type="password" name="pwd2" id="userPwd2" maxlength="15" placeholder="비밀번호를 입력하세요" required>
                <label id="pwdCheck_div2">&nbsp;</label>

                <br>
                <label for="userName" class="label">이름 </label> 
                <input class ="input all" type="text" name="name" id="userName" placeholder="한글로 2~10자리 이름입력" required>
                <label id="userNameCheck_div">&nbsp;</label>
                <br>
                <label for="phone" class="label">휴대폰 번호 </label> 
                <input class ="input all" type="tel" name="phone" id="phone" placeholder="-없이 입력" required>
                <label id="phoneCheck_div">&nbsp;</label>
                <br>
                <label for="email" class="label">이메일 </label> 
                <input class ="input all" type="email" name="email" id="email" placeholder="@포함하여 전부 입력" required>
                <label id="emailCheck_div">&nbsp;</label>
                <br>
                <label class="label">주소 </label> 
                <input type="text" name="address"
                class ="postcodify_postcode5 select all" placeholder="우편번호" id="address" readonly required>
                <button type="button" class="button1" id="postcodify_search_button">검색</button> <label id="addressCheck_div">&nbsp;</label>
                <br>
                <label class="label"> </label> 
                <input type="text" name="address"
                class ="postcodify_address input2 all" placeholder="도로명주소" readonly required>
                <br>
                <label class="label"> </label> 
                <input type="text" name="address"
                class ="postcodify_details input2 all" placeholder="상세주소" required>
                <br>
                <label for="petName" class="label">반려견 이름 </label> 
                <input class ="input all" type="text" name="petName" id="petName" placeholder="한글로 1자 ~ 10자리 입력" maxlength="10" required>
                <label id="petNameCheck_div">&nbsp;</label>
                <br>
                <label for="petAge" class="label">반려견 나이 </label> 
                <input class ="input all" type="text" name="petAge" id="petAge" placeholder="만 나이로 숫자만 입력" maxlength="2" required>
                <label id="petAgeCheck_div">&nbsp;</label>
                <br>
                <label for="petBreed" class="label">견종 </label> 
                <select class ="input all" name="breed" required>
                    <option value="골든 리트리버">골든 리트리버</option>
                    <option value="말티즈">말티즈</option>
                    <option value="비글">비글</option>
                    <option value="시바 이누">시바 이누</option>
                    <option value="시베리안 허스키">시베리안 허스키</option>
                    <option value="시츄">시츄</option>
                    <option value="요크셔테리어">요크셔테리어</option>
                    <option value="진돗개">진돗개</option>
                    <option value="푸들">푸들</option>
                    <option value="포메라니언">포메라니언</option>
                    <option value="기타">기타</option>
                </select>  
                <br>
                <label for="neuteredStatus" class="label">중성화 유무 </label> 
                <select class ="select all" name="status" required>
                    <option value="예">예</option> 
                    <option value="아니요">아니요</option> 
                    <option value="모름">모름</option> 
                </select>  
                <br>
                <label for="petGender" class="label" name="petGender" >반려견 성별 </label> 
                <select class ="select all" name="petGender" required>
                    <option value="암컷">암컷</option> 
                    <option value="수컷">수컷</option> 
                </select>  
                <br>

                
                
				<button type="submit" class="button2">가입하기</button>
                </form>

            </div>

        </div>


        <script src="//d1p7wdleee1q2z.cloudfront.net/post/search.min.js"></script>
	

	<!-- "검색" 단추를 누르면 팝업 레이어가 열리도록 설정한다 -->
	<!-- <script> $(function() { $("#postcodify_search_button").postcodifyPopUp(); }); </script>
    <script>
   
   
		
		let userId = document.getElementById("userId");
        let userPwd = document.getElementById("userPwd");
        let userPwd2 = document.getElementById("userPwd2");
        let userName = document.getElementById("userName");
        let phone = document.getElementById("phone");
        let email = document.getElementById("email");
        let petName = document.getElementById("petName");
        let petAge = document.getElementById("petAge");
        let address = document.getElementById("address");
        
        
        let userPwdresult = document.getElementById("pwdCheck_div");
        let userPwd2result = document.getElementById("pwdCheck_div2");
        let userNameresult = document.getElementById("userNameCheck_div");
        let phoneresult = document.getElementById("phoneCheck_div");
        let emailresult = document.getElementById("emailCheck_div");
        let petNameresult = document.getElementById("petNameCheck_div");
        let petAgeresult = document.getElementById("petAgeCheck_div");
        let addressresult = document.getElementById("addressCheck_div");
        
        
        let pwdCheck = false;
        let pwd2Check = false;
        let nameCheck = false;
        let phoneCheck = false;
        let emailCheck = false;
        let petNameCheck = false;
        let petAgeCheck = false;
        let addressCheck = false; 
        
		
		// 트림처리 후 못넘어가게 trim 공백 제거 함수  = ""빈문자열로 확인
		
		
		$("#idCheck").on('click', function () {
			var userId = $("[name=id]");
			let regExp = /(?=.*[a-z])(?=.*[0-9]).{8,10}/;
			// 아이디 중복 시 false, 아이디 사용 가능 시 true 값을 가지는 변수
			var isUsable = false;
			console.log(userId);
			if(!regExp.test(userId.val())){
				alert("아이디는 영문 소문자와 숫자를 포함하여 최소 8자리 이상이어야 합니다.");
				userId.focus();
			}else{
				//
				 var token = $("meta[name='_csrf']").attr("content");
				  var header = $("meta[name='_csrf_header']").attr("content");
				    
				$.ajax({
					url : "/member/idCheck",
					type : "post",
					//
					beforeSend : function(xhr){
						xhr.setRequestHeader(header, token);
					},
					data : {userId : userId.val() },
					success : function (result) {
						console.log(result);
						if(result == "fail"){
							alert("사용할 수 없는 아이디 입니다.");
							userId.focus();
						}else{
							if(confirm("사용 가능한 아이디 입니다. 사용하시겠습니까?")){
								// 더 이상 아이디 입력 공간을 바꿀 수 없도록 처리
								userId.attr('readonly', true);
								/* 사용 가능한 아이디라는 flag */
								isUsable = true;
							} else{
								// 다시 아이디 입력 공간을 바꿀 수 있도록 처리
								userId.attr('readonly', false);   //attr 제이쿼리 메소드
								userId.focus();
								/* 사용 불가능한 아이디라는 flag */
								isUsable = false;
							}
						}						
					},
					error : function (e) {
						console.log(e);
					}
				});
			}
			
		});
		
		
		userPwd.onblur = function(){
            let regExp = /(?=.*[a-zA-Z])(?=.*[0-9])(?=.*[^a-zA-Z0-9]).{8,}/;
            if(regExp.test(this.value)) {
                userPwdresult.classList.remove('invalid');
                userPwdresult.innerHTML = '&nbsp;';
                pwdCheck = true;
            }
            else {
                userPwdresult.classList.add('invalid');
                userPwdresult.innerHTML = '영문 대소문자 숫자 특수문자 포함 8~15 자리로 입력';
                pwdCheck = false;
            }
            if(this.value == "") {
                userPwdresult.innerHTML = '&nbsp;';
                pwdCheck = false;
            }
        };
        userPwd.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                userPwdresult.innerHTML = '&nbsp;';
                pwdCheck = false;
            }
        }

        userPwd2.onblur = function(){
            if(this.value == userPwd.value) {
                userPwd2result.classList.remove('invalid');
                userPwd2result.innerHTML = '&nbsp;';
                pwd2Check = true;
            }
            else {
                userPwd2result.classList.add('invalid');
                userPwd2result.innerHTML = '비밀번호가 일치하지 않습니다.';
                pwd2Check = false;
            }
            if(this.value == "") {
                userPwd2result.innerHTML = '&nbsp;';
                pwd2Check = false;
            }
        };
        userPwd2.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                userPwd2result.innerHTML = '&nbsp;';
                pwd2Check = false;
            }
        }
   
        userName.onblur = function(){
            let regExp = /^[가-힣]{2,}$/;
            if(regExp.test(this.value)) {
                userNameresult.classList.remove('invalid');
                userNameresult.innerHTML = '&nbsp;';
                nameCheck = true;
            }
            else {
                userNameresult.classList.add('invalid');
                userNameresult.innerHTML = '한글로 2~10 자리로 입력하세요.';
                nameCheck = false;
            }
            if(this.value == "") {
                userNameresult.innerHTML = '&nbsp;';
                nameCheck = false;
            }
        };
        userName.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                userNameresult.innerHTML = '&nbsp;';
                nameCheck = false;
            }
        }

        email.onblur = function(){
            let regExp = /^([a-zA-z0-9])+@([a-zA-Z])+\.[a-zA-Z]{2,3}/;
            if(regExp.test(this.value)) {
                emailresult.classList.remove('invalid');
                emailresult.innerHTML = '&nbsp;';
                emailCheck = true;
            }
            else {
                emailresult.classList.add('invalid');
                emailresult.innerHTML = '이메일 형식을 확인하세요.';
                emailCheck = false;
            }
            if(this.value == "") {
                emailresult.innerHTML = '&nbsp;';
                emailCheck = false;
            }
        };
        email.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                emailresult.innerHTML = '&nbsp;';
                emailCheck = false;
            }
        }

        phone.onblur = function(){
            let regExp = /^01[0-9]{1,}$/;
            if(regExp.test(this.value)) {
                phoneresult.classList.remove('invalid');
                phoneresult.innerHTML = '&nbsp;';
                phoneCheck = true;
            }
            else {
                phoneresult.classList.add('invalid');
                phoneresult.innerHTML = '전화번호 형식을 확인하세요.';
                phoneCheck = false;
            }
            if(this.value == "") {
                phoneresult.innerHTML = '&nbsp;';
                phoneCheck = false;
            }
        };

        phone.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                phoneresult.innerHTML = '&nbsp;';
                phoneCheck = false;
            }
        }
		
        
        petName.onblur = function(){
            let regExp = /^[가-힣]{1,}$/;
            if(regExp.test(this.value)) {
            	 petNameresult.classList.remove('invalid');
            	 petNameresult.innerHTML = '&nbsp;';
            	 petNameCheck = true;
            }
            else {
            	 petNameresult.classList.add('invalid');
            	 petNameresult.innerHTML = '한글로 1~10 자리로 입력하세요.';
            	 petNameCheck = false;
            }
            if(this.value == "") {
            	 petNameresult.innerHTML = '&nbsp;';
            	 petNameCheck = false;
            }
        };
        petName.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                petNameresult.innerHTML = '&nbsp;';
                petNameCheck = false;
            }
        }
        
        
        petAge.onblur = function(){
            let regExp = /^[0-9]{1,}$/;
            if(regExp.test(this.value)) {
            	petAgeresult.classList.remove('invalid');
            	petAgeresult.innerHTML = '&nbsp;';
            	petAgeCheck = true;
            }
            else {
            	petAgeresult.classList.add('invalid');
            	petAgeresult.innerHTML = '숫자로만 입력하세요';
            	petAgeCheck = false;
            }
            if(this.value == "") {
            	petAgeresult.innerHTML = '&nbsp;';
            	petAgeCheck = false;
            }
        };

        petAge.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                petAgeresult.innerHTML = '&nbsp;';
                petAgeCheck = false;
            }
        }	
        
        
        
        
        address.onblur = function(){
            let regExp =  /^[0-9]{1,}$/
            if(regExp.test(this.value)) {
                userPwdresult.classList.remove('invalid');
                userPwdresult.innerHTML = '&nbsp;';
                addressCheck = true;
            }
            else {
            	addressresult.classList.add('invalid');
            	addressresult.innerHTML = '주소를 입력하십시오';
                addressCheck = false;
            }
            if(this.value == "") {
            	addressresult.innerHTML = '&nbsp;';
                addressCheck = false;
            }
        };
        address.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                addressresult.innerHTML = '&nbsp;';
                addressCheck = false;
            }
        }
        
        
        
        
        
         address.onblur = function(){
        	let regExp = /^\d{1,}$/
            if(regExp.test(input.value)) {
            	addressCheck = true;
            }
            else {
            	addressCheck = false;
            }
        };
        
        
        function validate(){
			if(idCheck == false){
				console.log("회원가입 불가");
				userId.focus();
				return;
			}
			if(pwdCheck == false){
				console.log("회원가입 불가");
				userPwd.focus();
				return;
			}
			if(pwd2Check == false){
				console.log("회원가입 불가");
				userPwd2.focus();
				return;
			}
			if(nameCheck == false){
				console.log("회원가입 불가");
				userName.focus();
				return;
			}
			if(phoneCheck == false){
				console.log("회원가입 불가");
				phone.focus();
				return;
			}
			if(emailCheck == false){
				console.log("회원가입 불가");
				email.focus();
				return;
			}
			if(petNameCheck == false){
				console.log("회원가입 불가");
				console.log(petNameCheck);
				petName.focus();
				return;
			}
			if(petAgeCheck == false){
				console.log("회원가입 불가");
				console.log(petAgeCheck);
				petAge.focus();
				return;
			}
			if(addressCheck == false){
				address.focus();
				return;	
			} 
			else{
				console.log("회원가입 가능");
				document.forms.joinForm.submit();
			}
		}
        
	</script>
 -->




















<!-- 푸터 -->
    <div th:replace="fragments/footer.html"></div>


</body>
</html>