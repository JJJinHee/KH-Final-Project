<!DOCTYPE html>
<html lang="ko" xmlns:th="https://www.thymeleaf.org"
xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- 폰트  -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+KR&display=swap" rel="stylesheet"> 
    <!-- 공통 css -->
    <link type="text/css" rel="stylesheet" href="/css/common.css">
    <!-- 나현 css (메인, 관리자)-->
    <link type="text/css" rel="stylesheet" href="/css/nh.css">
    <!-- 공통 js -->
    <script type="text/javascript" src="/js/common.js"></script>

<meta id="_csrf" name="_csrf" th:content="${_csrf.token}"/>
<meta id="_csrf_header" name="_csrf_header" th:content="${_csrf.headerName}"/>

<title>다나은 동물병원</title>
<style>
        .wrapper{
            width: 1200px;
            height: 1080px;
            margin: auto;
            display: flex; 
            align-items: flex-start;      
            justify-content: flex-start;
        }
        .logo{
            width: 100%;
            margin-left: 0px;
            margin-top: 0px;
        }
        .item{
            align-self: flex-start;
            display: inline-block;
        }
        .info{
            margin: auto;
        }
        .infoForm{
            border: 1px solid gainsboro;
            width: 904px;   
            margin-left: 10px;    
        }

        .label{
            min-width: 160px;
            display:inline-block;
            margin-top: 25px;
            margin-left: 30px;
            font-weight: bold;
        }

        .all{
            height: 23px;
            border: 1px solid gainsboro;
            border-radius: 5px;
            padding-left: 5px;
            padding-right: 5px;

        }

        .input{
            display:inline-block;
            width: 180px;
        }

        .select{
            display:inline-block;
            width: 150px;
        }

        .input2{
            display:inline-block;
            width: 450px;
        }

        .button1{
            margin-left: 20px;
            width: 100px;
            height: 33px;
        }

        .button2{
            display: block;
            margin-left: auto;
            margin-right: auto;
            margin-top: 30px;
            margin-bottom: 10px;
            width: 180px;
            text-align: center;
            height: 40px;
        }

        input:focus,
        select:focus {
	    outline: none;
        }
        .button1:hover {
	    cursor: pointer;
        }
        .button2:hover {
	    cursor: pointer;
        }


        .My{
            display: block;
            margin-top: 303px;
            margin-right: 0px;
            margin-left: -300px;
            height: 50px;
            width: 300px;
            background-color: white;
            color: rgb(167, 164, 164);
            font-weight: bold;
            border: 1px solid gainsboro;
        }

        .btn{
            margin-top: 303px;
            color: rgb(21, 60, 162);
        }
        .btn1{
            margin-top: -18px;
        }
        .label1{
            min-width: 160px;
            display:inline-block;
            margin-top: 25px;
            font-weight: bold;
            font-size: x-large;
            margin-left: 25px;
            margin-bottom: 10px;
        }
        .etc{
            color: rgb(167, 164, 164);
            font-weight: bolder;
            margin-left: 25px;
        }
        .Withdraw{
            margin-left: 150px;
            width: 160px;
            height: 35px;
            background-color: rgb(21, 60, 162);
            color: white;
            border: 1px solid gray;
            border-radius: 5px;
        }
        button:hover{
            cursor: pointer;
            color: royalblue;
        }
        </style>
</head>
<body>
<div th:replace="fragments/header.html"></div>


        <div class="photo">
            <img class="logo" src="/images/member/memberService.png">
        </div>
        <div class="wrapper">
            <img class="my" src="/images/member/myPage.png">
            <div>
            <form id="myPageForm" th:action="@{/member/myPage}" method="post" onsubmit="return validate();"> 
            <button class="My btn" type="button" th:onclick="|location.href='@{/member/myPage}'|"> 정보 수정&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;> </button><br>
            <button class="My btn1" type="button" th:onclick="|location.href='@{/member/reservationConfirmation}'|"> 예약 확인&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;> </button>
            </div>
            <div class="infoForm item">
                
                <label class="label1">개인정보</label><br>
               <label class="etc">정보를 수정할 경우에는 <u>비밀번호를 꼭 다시 한 번 확인</u>하여 주십시오</label>
               <button class="Withdraw" type="button" th:onclick="|location.href='@{/member/withdrawal}'|">탈퇴하기</button><br><br>
               
               

                <label for="userid" class="label">아이디 </label> 
         
                 <input class ="input all" type="text" name="id" size="20" minlength="8" maxlength="10" th:value="${#authentication.principal.id}"  readonly>
                 <br>
                <label for="userpwd" class="label">비밀번호 </label> 
                <input class ="input all" type="password" name="pwd" minlength="8" maxlength="15"  placeholder="비밀번호를 입력하세요">
                <label id="pwdCheck_div">&nbsp;</label>
                <br>
                <label for="userpwd" class="label">비밀번호 재확인 </label> 
                <input class ="input all" type="password" name="pwd2" maxlength="15" placeholder="비밀번호를 입력하세요">
                <label id="pwdCheck_div2">&nbsp;</label>
                <br>
                <label for="username" class="label">이름 </label> 
                <input class ="input all" type="text" name="name" th:value="${#authentication.principal.name}" readonly>
                <br>
                <label for="phone" class="label">휴대폰 번호 </label> 
                <input class ="input all" type="tel" name="phone" th:value="${#authentication.principal.phone}" placeholder="-없이 입력">
                <label id="phoneCheck_div">&nbsp;</label>
                <br>
                <label for="phone" class="label">이메일 </label> 
                <input class ="input all" type="email" name="email" id="email" th:value="${#authentication.principal.email}" placeholder="@포함하여 전부 입력" required>
                <label id="emailCheck_div">&nbsp;</label>
               <!-- 타임리프 스플릿 검색  -->
                <br>
                <label class="label">주소 </label> 
                <input type="text" name="address"
                class ="postcodify_postcode5 select all" placeholder="우편번호" readonly>
                <button type="button" class="button1" th:value="${#authentication.principal.address}" id="postcodify_search_button">검색</button>
                <br>
                <label class="label"> </label> 
                <input type="text" name="address"
                class ="postcodify_address input2 all" th:value="${#authentication.principal.address}" placeholder="도로명주소" readonly>
                <br>
                <label class="label"> </label> 
                <input type="text" name="address"
                class ="postcodify_details input2 all" th:value="${#authentication.principal.address}" placeholder="상세주소">
                <br>
                <label for="petname" class="label">반려견 이름 </label>
                <input class ="input all" type="text" name="petName" th:value="${#authentication.principal.dogInformation.petName}" placeholder="반려견이름"> <!-- th:value="${#authentication.principal.petName}" -->
                <label id="petNameCheck_div">&nbsp;</label> 
                <br>
                <label for="petage" class="label">반려견 나이 </label> 
                <input class ="input all" type="text" name="petAge" th:value="${#authentication.principal.dogInformation.petAge}" placeholder="반려견나이"> <!-- th:value="${#authentication.principal.petAge}"  -->
                <label id="petAgeCheck_div">&nbsp;</label>
                <br>
                <label for="petBreed" class="label">견종 </label> 
                <select class ="input all" name="breed" required th:value="${#authentication.principal.dogInformation.breed}" > <!-- th:value="${#authentication.principal.breed}" -->
                    <option value="골든 리트리버">골든 리트리버</option>
                    <option value="말티즈">말티즈</option>
                    <option value="비글">비글</option>
                    <option value="시바 이누">시바 이누</option>
                    <option value="시베리안 허스키">시베리안 허스키</option>
                    <option value="시츄">시츄</option>
                    <option value="요크셔테리어">요크셔테리어</option>
                    <option value="진돗개">진돗개</option>
                    <option value="푸들">푸들</option>
                    <option value="포메라니언">포메라니언</option>
                    <option value="기타">기타</option>
                </select>  
                <br>
                <label for="neuteredStatus" class="label" >중성화 유무 </label> <!-- th:value="${#authentication.principal.status}" -->
                <select class ="select all" name="status" required th:value="${#authentication.principal.dogInformation.status}">
                    <option value="예">예</option> 
                    <option value="아니요">아니요</option> 
                    <option value="모름">모름</option> 
                </select>  
                <br>
                 <label for="petGender" class="label" name="petGender" >반려견 성별 </label> <!-- th:value="${#authentication.principal.petGender}" -->
                <select class ="select all" name="petGender" required th:value="${#authentication.principal.dogInformation.petGender}"><!-- 타임리프로 널여부 -->
                    <option value="암컷">암컷</option> 
                    <option value="수컷">수컷</option> 
                </select>   
                <br><br>


                <input type="submit" class="button2" value="수정하기">   
                </form> 

            </div>

        </div>





<script src="//d1p7wdleee1q2z.cloudfront.net/post/search.min.js"></script>
	

	<!-- "검색" 단추를 누르면 팝업 레이어가 열리도록 설정한다 -->
	<script> $(function() { $("#postcodify_search_button").postcodifyPopUp(); }); </script>
	
	<script>
   
   
		
	
        let userPwd = document.getElementById("userPwd");
        let userPwd2 = document.getElementById("userPwd2");
        let phone = document.getElementById("phone");
        let email = document.getElementById("email");
        let petName = document.getElementById("petName");
        let petAge = document.getElementById("petAge");
        let address = document.getElementById("address");
        
        
        let userPwdresult = document.getElementById("pwdCheck_div");
        let userPwd2result = document.getElementById("pwdCheck_div2");
        let phoneresult = document.getElementById("phoneCheck_div");
        let emailresult = document.getElementById("emailCheck_div");
        let petNameresult = document.getElementById("petNameCheck_div");
        let petAgeresult = document.getElementById("petAgeCheck_div");
        
        
        let pwdCheck = false;
        let pwd2Check = false;
        let phoneCheck = false;
        let emailCheck = false;
        let petNameCheck = false;
        let petAgeCheck = false;
        
		

		
		
		userPwd.onblur = function(){
            let regExp = /(?=.*[a-zA-Z])(?=.*[0-9])(?=.*[^a-zA-Z0-9]).{8,}/;
            if(regExp.test(this.value)) {
                userPwdresult.classList.remove('invalid');
                userPwdresult.innerHTML = '&nbsp;';
                pwdCheck = true;
            }
            else {
                userPwdresult.classList.add('invalid');
                userPwdresult.innerHTML = '영문 대소문자 숫자 특수문자 포함 8~15 자리로 입력';
                pwdCheck = false;
            }
            if(this.value == "") {
                userPwdresult.innerHTML = '&nbsp;';
                pwdCheck = false;
            }
        };
        userPwd.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                userPwdresult.innerHTML = '&nbsp;';
                pwdCheck = false;
            }
        }

        userPwd2.onblur = function(){
            if(this.value == userPwd.value) {
                userPwd2result.classList.remove('invalid');
                userPwd2result.innerHTML = '&nbsp;';
                pwd2Check = true;
            }
            else {
                userPwd2result.classList.add('invalid');
                userPwd2result.innerHTML = '비밀번호가 일치하지 않습니다.';
                pwd2Check = false;
            }
            if(this.value == "") {
                userPwd2result.innerHTML = '&nbsp;';
                pwd2Check = false;
            }
        };
        userPwd2.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                userPwd2result.innerHTML = '&nbsp;';
                pwd2Check = false;
            }
        }
   
        
        email.onblur = function(){
            let regExp = /^([a-zA-z0-9])+@([a-zA-Z])+\.[a-zA-Z]{2,3}/;
            if(regExp.test(this.value)) {
                emailresult.classList.remove('invalid');
                emailresult.innerHTML = '&nbsp;';
                emailCheck = true;
            }
            else {
                emailresult.classList.add('invalid');
                emailresult.innerHTML = '이메일 형식을 확인하세요.';
                emailCheck = false;
            }
            if(this.value == "") {
                emailresult.innerHTML = '&nbsp;';
                emailCheck = false;
            }
        };
        email.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                emailresult.innerHTML = '&nbsp;';
                emailCheck = false;
            }
        }

        phone.onblur = function(){
            let regExp = /^01[0-9]{1,}$/;
            if(regExp.test(this.value)) {
                phoneresult.classList.remove('invalid');
                phoneresult.innerHTML = '&nbsp;';
                phoneCheck = true;
            }
            else {
                phoneresult.classList.add('invalid');
                phoneresult.innerHTML = '전화번호 형식을 확인하세요.';
                phoneCheck = false;
            }
            if(this.value == "") {
                phoneresult.innerHTML = '&nbsp;';
                phoneCheck = false;
            }
        };

        phone.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                phoneresult.innerHTML = '&nbsp;';
                phoneCheck = false;
            }
        }
		
        
        petName.onblur = function(){
            let regExp = /^[가-힣]{1,}$/;
            if(regExp.test(this.value)) {
            	 petNameresult.classList.remove('invalid');
            	 petNameresult.innerHTML = '&nbsp;';
            	 petNameCheck = true;
            }
            else {
            	 petNameresult.classList.add('invalid');
            	 petNameresult.innerHTML = '한글로 1~10 자리로 입력하세요.';
            	 petNameCheck = false;
            }
            if(this.value == "") {
            	 petNameresult.innerHTML = '&nbsp;';
            	 petNameCheck = false;
            }
        };
        petName.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                petNameresult.innerHTML = '&nbsp;';
                petNameCheck = false;
            }
        }
        
        
        petAge.onblur = function(){
            let regExp = /^[0-9]{1,}$/;
            if(regExp.test(this.value)) {
            	petAgeresult.classList.remove('invalid');
            	petAgeresult.innerHTML = '&nbsp;';
            	petAgeCheck = true;
            }
            else {
            	petAgeresult.classList.add('invalid');
            	petAgeresult.innerHTML = '숫자로만 입력하세요';
            	petAgeCheck = false;
            }
            if(this.value == "") {
            	petAgeresult.innerHTML = '&nbsp;';
            	petAgeCheck = false;
            }
        };

        petAge.onfocus = function(){
            if(this.classList.contains('invalid')){
                this.classList.remove('invalid');
                petAgeresult.innerHTML = '&nbsp;';
                petAgeCheck = false;
            }
        }	
        
        address.onblur = function(){
            if(address == null) {
            	address = false;
            }
            else {
            	address = true;
            }
        };
        
        
        function validate(){
			
			if(pwdCheck == false){
				console.log("정보수정 불가");
				userPwd.focus();
				return;
			}
			if(pwd2Check == false){
				console.log("정보수정 불가");
				userPwd2.focus();
				return;
			}
			
			if(phoneCheck == false){
				console.log("정보수정 불가");
				phone.focus();
				return;
			}
			if(emailCheck == false){
				console.log("정보수정 불가");
				email.focus();
				return;
			}
			if(petNameCheck == false){
				console.log("정보수정 불가");
				console.log(petNameCheck);
				petName.focus();
				return;
			}
			if(petAgeCheck == false){
				console.log("정보수정 불가");
				console.log(petAgeCheck);
				petAge.focus();
				return;
			}
			if(address == false){
				address.focus();
				return;	
			}
			else{
				console.log("정보수정 가능");
				document.forms.joinForm.submit();
			}
		}
        
	</script>



<!-- 푸터 -->
    <div th:replace="fragments/footer.html"></div>
</body>
</html>